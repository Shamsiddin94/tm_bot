<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/core}">
<th:block layout:fragment="title">
    Savolllar
</th:block>
<th:block layout:fragment="styles">
    <!-- Dashboard styles-->
</th:block>

<div class="content" layout:fragment="page_content" id="app">
    <h1> Savollar</h1>


    <div class="box">
        <div class="box-header">
            <a href="#" class="btn btn-success"><i class="fa fa-plus"></i></a><br>
        </div>
        <div class="box-body">


            <div class="box bg-info" v-if="visible">
                <div class="box-header bg-gray-light">
                    <h5>gegdfgdgd</h5>
                </div>
                <div class="box-body">
                    <div class="form-group col-md-3">
                        <label for="25331 ">Savol matnini kiriting</label>
                        <input id="25331 " class="form-control" type="text" v-model="name">
                    </div>
                    <div class="form-group col-md-3">
                        <label for="25332 ">Savol matnini kiriting</label>
                        <input id="25332 " class="form-control" type="text" >
                    </div>
                    <div class="form-group col-md-3">
                        <label for="25333 ">Savol matnini kiriting</label>
                        <input id="25333 "  class="form-control" type="text" v-model="name">
                    </div>
                    <div class="form-group col-md-3">
                        <label for="25334 ">Savol matnini kiriting</label>
                        <input id="25334 " class="form-control" type="text">
                    </div>
                </div>
            </div>

            <table class="table table-bordered table-hover text-center ">
                <thead class="text-primary bg-info">
                <tr>
                    <th> Id</th>
                    <th>Nomer</th>
                    <th>Nomer</th>
                    <th> Nomi</th>
                    <th>Turi</th>
                    <th>Savollar soni</th>
                    <th>Sana</th>
                </tr>
                <tr>
                    <th><input class="form-control" type="number" v-model="searchId" @change="getData()"></th>
                    <th><input class="form-control" type="number" v-model="searchNum" @change="getData()"></th>
                    <th><input class="form-control" type="text" v-model="searchTextNumber" @change="getData()"></th>
                    <th><input class="form-control" type="text" v-model="searchText" @change="getData()"></th>
                    <th><input class="form-control" type="text" v-model="searchType" @change="getData()"></th>
                    <th></th>
                    <th></th>



                </tr>
                </thead>
                <tbody>
                <tr v-for="question in qFilter" :id="'row_'+question.id"
                    :key-="question.id">

                    <td>{{question.id}}</td>
                    <td>{{question.num}}</td>
                    <td>{{question.textNumber}}</td>
                    <td v-on:click="trClick(question.id)" >{{question.text}} :key-="question.id"> </td>
                    <td>{{question.type}}</td>
                    <td>{{question.answers.length}}</td>
                    <td>{{question.createdAt}}</td>
                    <!-- <td>
                         <button class="btn btn-success">Edit</button>
                         <button class="btn btn-danger">Delete</button>
                     </td>-->


                </tr>

                </tbody>
            </table>

        </div>


    </div>


    <nav aria-label="Page navigation example">
        <ul class="pagination">
            <li class="page-item">
                <a class="page-link" href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                </a>
            </li>
            <li class="page-item"><a class="page-link " href="#">1</a></li>
            <li class="page-item active"><a class="page-link " href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item">
                <a class="page-link" href="#" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
            </li>
        </ul>
    </nav>

    <pagination
            type="text/x-template"
            id="pagination"
            :total-pages="11"
            :total="113"
            :per-page="10"
            :current-page="currentPage"
            @pagechanged="onPageChange"
    >
        <ul class="pagination">
            <li
                    class="pagination-item"
            >
                <button
                        type="button"
                        @click="onClickFirstPage"
                        :disabled="isInFirstPage"
                        aria-label="Go to first page"
                >
                    First
                </button>
            </li>

            <li
                    class="pagination-item"
            >
                <button
                        type="button"
                        @click="onClickPreviousPage"
                        :disabled="isInFirstPage"
                        aria-label="Go to previous page"
                >
                    Previous
                </button>
            </li>

            <li v-for="page in pages" class="pagination-item">
                <button
                        type="button"
                        @click="onClickPage(page.name)"
                        :disabled="page.isDisabled"
                        :class="{ active: isPageActive(page.name) }"
                        :aria-label="`Go to page number ${page.name}`"

                >
                    {{ page.name }}
                </button>
            </li>

            <li class="pagination-item">
                <button
                        type="button"
                        @click="onClickNextPage"
                        :disabled="isInLastPage"
                        aria-label="Go to next page"
                >
                    Next
                </button>
            </li>

            <li class="pagination-item">
                <button
                        type="button"
                        @click="onClickLastPage"
                        :disabled="isInLastPage"
                        aria-label="Go to last page"
                >
                    Last
                </button>
            </li>
        </ul>
    </pagination>

</div>



</div>

<th:block layout:fragment="scripts">


    <!-- Actual Vue.js script -->
    <script type="text/javascript">

        Vue.component('pagination',{
            template: '#pagination',
            props: {
                maxVisibleButtons: {
                    type: Number,
                    required: false,
                    default: 4
                },
                totalPages: {
                    type: Number,
                    required: true
                },
                total: {
                    type: Number,
                    required: true
                },
                perPage: {
                    type: Number,
                    required: true
                },
                currentPage: {
                    type: Number,
                    required: true
                },
            },
            computed: {
                startPage() {
                    if (this.currentPage === 1) {
                        return 1;
                    }

                    if (this.currentPage === this.totalPages) {
                        return this.totalPages - this.maxVisibleButtons + 1;
                    }

                    return this.currentPage - 1;

                },
                endPage() {

                    return Math.min(this.startPage + this.maxVisibleButtons - 1, this.totalPages);

                },
                pages() {
                    const range = [];

                    for (let i = this.startPage; i <= this.endPage; i+= 1 ) {
                        range.push({
                            name: i,
                            isDisabled: i === this.currentPage
                        });
                    }

                    return range;
                },

                isInFirstPage() {
                    return this.currentPage === 1;
                },
                isInLastPage() {
                    return this.currentPage === this.totalPages;
                },
            },
            methods: {
                onClickFirstPage() {
                    this.$emit('pagechanged', 1);
                },
                onClickPreviousPage() {
                    this.$emit('pagechanged', this.currentPage - 1);
                },
                onClickPage(page) {
                    this.$emit('pagechanged', page);
                },
                onClickNextPage() {
                    this.$emit('pagechanged', this.currentPage + 1);
                },
                onClickLastPage() {
                    this.$emit('pagechanged', this.totalPages);
                },
                isPageActive(page) {
                    return this.currentPage === page;
                },
            }
        });



        $.toast('Here you can put the text of the toast');

        var app = new Vue({

            el: '#app',
            data: {

                    currentPage: 1,
                   //search
                    searchId:'',
                    searchNum:'',
                    searchTextNumber:'',
                    searchText:'',
                    searchType:'',

                    name: 'eeeeeeeee',

                    data:null,
                    visible: false,
                    questions: null

            },
            mounted() {
                axios.get("/admin/quiz/api/question/all")
                    .then(response => (

                        this.questions = response.data

                            /*.sort(function (a, b) {
                            return parseInt(a.id) - parseInt(b.id);
                        })
                        */
                        ));

                console.log(this.questions);
            },
            methods: {
                onPageChange(page) {
                    console.log(page)
                    this.currentPage = page;
                },
                getPage(){
                },
                getData(e){

                    axios.post("/admin/quiz/api/question/search",
                        {
                            id: this.searchId,
                            num: this.searchNum,
                            textNumber: this.searchTextNumber,
                            text: this.searchText,
                            type: this.searchType
                        })
                        .then(response => (

                            this.questions = response.data ));
                    console.log(this.searchName);
                    console.log(this.questions);

                },
                trClick(id) {

                    var temp=this.questions.find(i=>i.id==id);





                    this.visible = !this.visible;
                    console.log(id);
                },

            },
            watch:{
                searchName: function (newV,oldV) {
                    console.log('eski='+oldV+' yangi='+newV);
                }
            },
            computed: {
                qFilter() {
                    const {searchName, questions} = this

                    console.log(searchName);
                    return this.questions;
                        //.filter(person => person.name.toLowerCase().indexOf(searchName.toLowerCase()) > -1)
                    //.filter(person => person.age === age)
                },
            }

        })
    </script>
    <!--my scripts-->
</th:block>


</html>